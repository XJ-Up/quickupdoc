import { computed as v, ref as C, watchEffect as P } from "vue";
import { useRun as d } from "../use-run/index.js";
const z = (e, h) => {
  const { run: c } = d(), u = v(() => {
    const t = Math.floor(e.total / e.pageSize);
    return e.total % e.pageSize === 0 ? t : t + 1;
  }), m = v(() => {
    const t = Number(e.pagerCount), n = Number(e.current), i = (t - 1) / 2;
    let r = !1, o = !1;
    const s = [];
    if (u.value > t)
      e.current > t - i && (r = !0), e.current < u.value - i && (o = !0);
    else {
      for (let a = 2; a < u.value; a++)
        s.push(a);
      return s;
    }
    if (!r && o)
      for (let a = 2; a < t; a++)
        s.push(a);
    else if (r && !o) {
      const a = u.value - (t - 2);
      for (let l = a; l < u.value; l++)
        s.push(l);
    } else if (r && o) {
      const a = Math.floor(t / 2) - 1;
      for (let l = n - a; l <= n + a; l++)
        s.push(l);
    } else
      for (let a = 2; a < t; a++)
        s.push(a);
    return s;
  }), M = (t) => {
    if (e.disabled)
      return;
    let n;
    c({
      /** 下一页切换 */
      next: () => {
        const r = e.current === u.value ? u.value : e.current + 1;
        h.currentModelValue.value = r, c(e.onNext, r, e.pageSize), c(e.onChange, r, e.pageSize);
      },
      /**上一页切换 */
      prev: () => {
        n = e.current === 1 ? 1 : e.current - 1, h.currentModelValue.value = n, c(e.onPrev, n, e.pageSize), c(e.onChange, n, e.pageSize);
      }
    }[t]);
  }, f = C(!1), g = C(!1);
  return P(() => {
    const t = Number(e.pagerCount), n = (t - 1) / 2;
    f.value = !1, g.value = !1, u.value > t && (e.current > t - n && (f.value = !0), e.current < u.value - n && (g.value = !0));
  }), { pages: m, showNextMore: g, showPrevMore: f, maxCount: u, handelTurnPages: M };
};
export {
  z as usePage
};
