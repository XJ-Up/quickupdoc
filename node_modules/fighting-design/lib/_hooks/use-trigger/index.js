"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var u=require("vue"),E=require("../../_tokens/key/index2.js"),y=require("../../_utils/utils/index.js"),C=require("../use-run/index.js");const T=(n,i)=>{const{run:a}=C.useRun(),c=u.reactive({x:"",y:""}),m=u.computed(()=>{const{spacing:e,enterDuration:t,leaveDuration:l}=n;return{"--trigger-content-x":c.x,"--trigger-content-y":c.y,"--trigger-spacing-size":y.sizeChange(e),"--trigger-enter-duration":t&&t+"s","--trigger-leave-duration":l&&l+"s"}}),v=()=>{const e=i.value;if(!e)return;const{left:t,top:l,height:w}=e.getBoundingClientRect(),h=t+window.scrollX,x=l+window.scrollY+w;c.x=h+"px",c.y=x+"px"},r=u.ref(!1);let s=!1;const g=e=>{if(!n.disabled){if(r.value){s=!0;return}v(),r.value=!0,s=!0,a(n.onOpen,r.value,e),a(n.onChange,r.value,e)}},o=e=>{if(n.disabled)return;s=!1;const t=()=>{r.value=!1,a(n.onClose,r.value,e),a(n.onChange,r.value,e)};if(n.trigger==="click"){t();return}setTimeout(()=>{s||t()},300)},d=()=>{s=!0},f=()=>{i.value&&(n.trigger==="hover"&&(i.value.addEventListener("mouseenter",g),i.value.addEventListener("mouseleave",o)),n.trigger==="click"&&i.value.addEventListener("click",g))};u.onMounted(f),u.watch(()=>n.trigger,f);const L=e=>{const t=e.target;t.closest("."+E.TRIGGER_CONTENT_BOX_CLASS)||t.closest("."+E.TRIGGER_CLASS)||(o(e),window.removeEventListener("click",L,!0),window.removeEventListener("resize",v))};return{visible:r,styleList:m,close:o,onBeforeEnter:e=>{if(n.trigger==="hover"){const t=e;t.addEventListener("mouseenter",d),t.addEventListener("mouseleave",o)}window.addEventListener("resize",v),window.addEventListener("click",L,!0)},onAfterLeave:e=>{if(n.trigger==="hover"){const t=e;t.removeEventListener("mouseenter",d),t.removeEventListener("mouseleave",o)}}}};exports.useTrigger=T;
